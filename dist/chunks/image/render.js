(window.webpackJsonp_ultimate_addons_for_gutenberg=window.webpackJsonp_ultimate_addons_for_gutenberg||[]).push([[67],{457:function(e,t,i){"use strict";i.r(t);var o=i(3),n=i.n(o),l=i(152),a=i(6),c=i(9),r=i(4),s=i(2),d=i(1),u=i(153),m=Object(s.createElement)(u.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Object(s.createElement)(u.Path,{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM5 4.5h14c.3 0 .5.2.5.5v8.4l-3-2.9c-.3-.3-.8-.3-1 0L11.9 14 9 12c-.3-.2-.6-.2-.8 0l-3.6 2.6V5c-.1-.3.1-.5.4-.5zm14 15H5c-.3 0-.5-.2-.5-.5v-2.4l4.1-3 3 1.9c.3.2.7.2.9-.1L16 12l3.5 3.4V19c0 .3-.2.5-.5.5z"}));function v({temporaryURL:e,attributes:{url:t="",alt:i,caption:o,align:n,id:l,href:a,rel:c,linkClass:r,linkDestination:s,title:d,width:u,height:m,linkTarget:v,sizeSlug:g}}){return React.createElement(React.Fragment,null,React.createElement("img",{id:l,src:t}))}const g=["image"],f=e=>{e=e.parentProps;const{attributes:t,setAttributes:i,className:o,isSelected:a,insertBlocksAfter:u,noticeOperations:f,onReplace:p,context:b,clientId:h}=e,{url:w,alt:R,caption:k,align:E,id:O,href:j,rel:S,linkClass:B,linkDestination:_,title:z,width:L,height:U,linkTarget:y,sizeSlug:P}=t,[C,D]=Object(s.useState)(),N=Object(s.useRef)();Object(s.useEffect)(()=>{N.current=R},[R]);const A=Object(s.useRef)();Object(s.useEffect)(()=>{A.current=k},[k]);const I=Object(s.useRef)(),{imageDefaultSize:M,mediaUpload:T}=Object(c.useSelect)(e=>{const{getSettings:t}=e(r.store),{imageDefaultSize:i,mediaUpload:o}=t();return{imageDefaultSize:i,mediaUpload:o}},[]);function x(){(e=>{var t,i;return((null===(t=wp)||void 0===t||null===(i=t.media)||void 0===i?void 0:i.attachment(e))||{}).destroyed})(null==t?void 0:t.id)&&i({url:void 0,id:void 0})}function V(e){f.removeAllNotices(),f.createErrorNotice(e)}function F(e){var o,n,a,c,r;if(!e||!e.url)return void i({url:void 0,alt:void 0,id:void 0,title:void 0,caption:void 0});if(Object(l.isBlobURL)(e.url))return void D(e.url);D();let s,d=((e,t)=>{const{alt:i,id:o,link:n,caption:l}=e,a={alt:i,id:o,link:n,caption:l};return a.url=e.url,a})(e);var u,m;A.current&&!get(d,["caption"])&&(d=omit(d,["caption"])),s=e.id&&e.id===O?{url:w}:{width:void 0,height:void 0,sizeSlug:(u=e,m=M,u.hasOwnProperty("sizes")||u.hasOwnProperty("url")||u.hasOwnProperty("media_details")||u.hasOwnProperty("source_url")||void 0!==u[m]?M:"full")};let v,g=t.linkDestination;if(!g)switch((null===(o=wp)||void 0===o||null===(n=o.media)||void 0===n||null===(a=n.view)||void 0===a||null===(c=a.settings)||void 0===c||null===(r=c.defaultProps)||void 0===r?void 0:r.link)||"none"){case"file":case"media":g="media";break;case"post":case"attachment":g="attachment";break;case"custom":g="custom";break;case"none":g="none"}switch(g){case"media":v=e.url;break;case"attachment":v=e.link}d.href=v,i({...d,...s,linkDestination:g})}function H(e){e!==w&&i({url:e,id:void 0,width:void 0,height:void 0,sizeSlug:M})}let J=((e,t)=>!e&&Object(l.isBlobURL)(t))(O,w);Object(s.useEffect)(()=>{if(!J)return;const e=getBlobByURL(w);e&&T({filesList:[e],onFileChange:([e])=>{F(e)},allowedTypes:g,onError:e=>{J=!1,f.createErrorNotice(e),i({src:void 0,id:void 0,url:void 0})}})},[]),Object(s.useEffect)(()=>{J?D(w):Object(l.revokeBlobURL)(C)},[J,w]);const G=((e,t)=>t&&!e&&!Object(l.isBlobURL)(t))(O,w)?w:void 0,q=!!w&&React.createElement("img",{alt:Object(d.__)("Edit image"),title:Object(d.__)("Edit image"),className:"edit-image-preview",src:w}),K=n()(o,{"is-transient":C,"is-resized":!!L||!!U,["size-"+P]:P}),Q=Object(r.useBlockProps)({ref:I,className:K});return React.createElement(React.Fragment,null,React.createElement("figure",Q,(C||w)&&React.createElement(v,{temporaryURL:C,attributes:t,setAttributes:i,isSelected:a,insertBlocksAfter:u,onReplace:p,onSelectImage:F,onSelectURL:H,onUploadError:V,containerRef:I,context:b,clientId:h,onCloseModal:x,onImageLoadError:function(e=!1){e||i({url:void 0,id:void 0})}}),!w&&React.createElement(r.BlockControls,{group:"block"},React.createElement(r.BlockAlignmentControl,{value:E,onChange:function(e){const t=["wide","full"].includes(e)?{width:void 0,height:void 0}:{};i({...t,align:e})}})),React.createElement(r.MediaPlaceholder,{icon:React.createElement(r.BlockIcon,{icon:m}),onSelect:F,onSelectURL:H,onError:V,onClose:x,accept:"image/*",allowedTypes:g,value:{id:O,src:G},mediaPreview:q,disableMediaButtons:C||w})))};f.propTypes={},f.defaultProps={},t.default=Object(a.withNotices)(f)}}]);