(window.webpackJsonp_ultimate_addons_for_gutenberg=window.webpackJsonp_ultimate_addons_for_gutenberg||[]).push([[67],{460:function(e,t,i){"use strict";i.r(t);var a=i(3),n=i.n(a),l=i(152),o=i(6),r=i(9),c=i(2),s=i(153),d=Object(c.createElement)(s.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},Object(c.createElement)(s.Path,{d:"M18.5 15v3.5H13V6.7l4.5 4.1 1-1.1-6.2-5.8-5.8 5.8 1 1.1 4-4v11.7h-6V15H4v5h16v-5z"})),u=i(4),m=i(1),g=i(10),h=Object(c.createElement)(s.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Object(c.createElement)(s.Path,{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM5 4.5h14c.3 0 .5.2.5.5v8.4l-3-2.9c-.3-.3-.8-.3-1 0L11.9 14 9 12c-.3-.2-.6-.2-.8 0l-3.6 2.6V5c-.1-.3.1-.5.4-.5zm14 15H5c-.3 0-.5-.2-.5-.5v-2.4l4.1-3 3 1.9c.3.2.7.2.9-.1L16 12l3.5 3.4V19c0 .3-.2.5-.5.5z"})),b=i(13),v=i(154),p=(i(155),i(156));const f=(e,t)=>t&&!e&&!Object(l.isBlobURL)(t),w=["image"];function O({temporaryURL:e,attributes:{url:t="",alt:i,caption:a,align:n,id:l,href:s,rel:d,linkClass:g,linkDestination:h,title:f,width:w,height:O,linkTarget:E,sizeSlug:R},setAttributes:j,isSelected:k,insertBlocksAfter:S,onReplace:B,onCloseModal:_,onSelectImage:y,onSelectURL:z,onUploadError:I,containerRef:L,context:U,clientId:C,onImageLoadError:x}){var W;const H=Object(c.useRef)(),{allowResize:P=!0}=(Object(c.useRef)(),Object(b.usePrevious)(t),U),{getBlock:M}=Object(r.useSelect)(u.store),{replaceBlocks:T,toggleSelection:D}=Object(r.useDispatch)(u.store),{image:A,multiImageSelection:N}=Object(r.useSelect)(e=>{const{getMedia:t}=e(p.store),{getMultiSelectedBlockClientIds:i,getBlockName:a}=e(u.store),n=i();return{image:l&&k?t(l):null,multiImageSelection:n.length&&n.every(e=>"core/image"===a(e))}},[l,k]),{canInsertCover:V,imageEditing:F,imageSizes:G,maxWidth:J,mediaUpload:q}=Object(r.useSelect)(e=>{const{getBlockRootClientId:t,getSettings:i,canInsertBlockType:a}=e(u.store),n=t(C),{imageEditing:l,imageSizes:o,maxWidth:r,mediaUpload:c}=i();return{imageEditing:l,imageSizes:o,maxWidth:r,mediaUpload:c,canInsertCover:a("core/cover",n)}},[C]),K=Object(b.useViewportMatch)("medium"),Q=["wide","full"].includes(n),[{loadedNaturalWidth:X,loadedNaturalHeight:Y},Z]=Object(c.useState)({}),[$,ee]=Object(c.useState)(!1),[te,ie]=Object(c.useState)(),ae=function(e,t){const[i,a]=Object(c.useState)();function n(){a(e.current.clientWidth)}return Object(c.useEffect)(n,t),Object(c.useEffect)(()=>{const{defaultView:t}=e.current.ownerDocument;return t.addEventListener("resize",n),()=>{t.removeEventListener("resize",n)}},[]),i}(L,[n]),ne=P&&!(Q&&K),{naturalWidth:le,naturalHeight:oe}=Object(c.useMemo)(()=>{var e,t;return{naturalWidth:(null===(e=H.current)||void 0===e?void 0:e.naturalWidth)||X||void 0,naturalHeight:(null===(t=H.current)||void 0===t?void 0:t.naturalHeight)||Y||void 0}},[X,Y,null===(W=H.current)||void 0===W?void 0:W.complete]),re=Object(v.getFilename)(t);let ce;ce=i||(re?Object(m.sprintf)(
/* translators: %s: file name */
Object(m.__)("This image has an empty alt attribute; its file name is %s"),re):Object(m.__)("This image has an empty alt attribute"));let se,de,ue=React.createElement(React.Fragment,null,React.createElement("img",{src:e||t,alt:ce,onError:()=>onImageError(),onLoad:e=>{var t,i;Z({loadedNaturalWidth:null===(t=e.target)||void 0===t?void 0:t.naturalWidth,loadedNaturalHeight:null===(i=e.target)||void 0===i?void 0:i.naturalHeight})},ref:H}),e&&React.createElement(o.Spinner,null));if(ae&&le&&oe){const e=le>ae,t=oe/le;se=e?ae:le,de=e?ae*t:oe}if(l&&le&&oe&&F&&$)ue=React.createElement(u.__experimentalImageEditor,{url:t,width:w,height:O,clientWidth:ae,naturalHeight:oe,naturalWidth:le});else if(ne&&se){const e=w||se,t=O||de,i=le/oe,a=le<oe?20:20*i,l=oe<le?20:20/i,r=2.5*J;let c=!1,s=!1;"center"===n?(c=!0,s=!0):Object(m.isRTL)()?"left"===n?c=!0:s=!0:"right"===n?s=!0:c=!0,ue=React.createElement(o.ResizableBox,{size:{width:w||"auto",height:O||"auto"},showHandle:k,minWidth:a,maxWidth:r,minHeight:l,maxHeight:r/i,lockAspectRatio:!0,enable:{top:!1,right:c,bottom:!0,left:s},onResizeStart:function(){D(!1)},onResizeStop:(i,a,n,l)=>{D(!0),j({width:parseInt(e+l.width,10),height:parseInt(t+l.height,10)})}},ue)}else ue=React.createElement("div",{style:{width:w,height:O}},ue);return React.createElement(React.Fragment,null,React.createElement(u.__experimentalImageEditingProvider,{id:l,url:t,naturalWidth:le,naturalHeight:oe,clientWidth:ae,onSaveImage:e=>j(e),isEditing:$,onFinishEditing:()=>ee(!1)},ue))}function E(){return(E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e}).apply(this,arguments)}const R=e=>{e=e.parentProps;const{attributes:t,setAttributes:i,className:a,isSelected:s,insertBlocksAfter:b,onReplace:v,context:p,clientId:R}=e,{block_id:j,url:k,alt:S,caption:B,align:_,id:y,href:z,rel:I,linkClass:L,linkDestination:U,title:C,width:x,height:W,linkTarget:H,sizeSlug:P}=t,M=Object(g.a)(),{createNotice:T}=Object(r.useDispatch)("core/notices"),[D,A]=Object(c.useState)(),[N,V]=Object(c.useState)(),F=Object(c.useRef)();Object(c.useEffect)(()=>{F.current=S},[S]);const G=Object(c.useRef)();Object(c.useEffect)(()=>{G.current=B},[B]);const J=Object(c.useRef)(),{imageDefaultSize:q,mediaUpload:K}=Object(r.useSelect)(e=>{const{getSettings:t}=e(u.store),{imageDefaultSize:i,mediaUpload:a}=t();return{imageDefaultSize:i,mediaUpload:a}},[]);function Q(){(e=>{var t,i;return((null===(t=wp)||void 0===t||null===(i=t.media)||void 0===i?void 0:i.attachment(e))||{}).destroyed})(null==t?void 0:t.id)&&i({url:void 0,id:void 0})}function X(e){T("error",e,{type:"snackbar"})}function Y(e){var a,n,o,r,c;if(!e||!e.url)return void i({url:void 0,alt:void 0,id:void 0,title:void 0,caption:void 0});if(Object(l.isBlobURL)(e.url))return void A(e.url);A();let s,d=((e,t)=>{const{alt:i,id:a,link:n,caption:l}=e,o={alt:i,id:a,link:n,caption:l};return o.url=e.url,o})(e);var u,m;G.current&&!get(d,["caption"])&&(d=omit(d,["caption"])),s=e.id&&e.id===y?{url:k}:{width:void 0,height:void 0,sizeSlug:(u=e,m=q,u.hasOwnProperty("sizes")||u.hasOwnProperty("url")||u.hasOwnProperty("media_details")||u.hasOwnProperty("source_url")||void 0!==u[m]?q:"full")};let g,h=t.linkDestination;if(!h)switch((null===(a=wp)||void 0===a||null===(n=a.media)||void 0===n||null===(o=n.view)||void 0===o||null===(r=o.settings)||void 0===r||null===(c=r.defaultProps)||void 0===c?void 0:c.link)||"none"){case"file":case"media":h="media";break;case"post":case"attachment":h="attachment";break;case"custom":h="custom";break;case"none":h="none"}switch(h){case"media":g=e.url;break;case"attachment":g=e.link}d.href=g,i({...d,...s,linkDestination:h})}function Z(e){e!==k&&i({url:e,id:void 0,width:void 0,height:void 0,sizeSlug:q})}function $(e){const t=["wide","full"].includes(e)?{width:void 0,height:void 0}:{};i({...t,align:e})}let ee=((e,t)=>!e&&Object(l.isBlobURL)(t))(y,k);Object(c.useEffect)(()=>{if(!ee)return;const e=getBlobByURL(k);e&&K({filesList:[e],onFileChange:([e])=>{Y(e)},allowedTypes:w,onError:e=>{ee=!1,T("error",e,{type:"snackbar"}),i({src:void 0,id:void 0,url:void 0})}})},[]),Object(c.useEffect)(()=>{ee?A(k):Object(l.revokeBlobURL)(D)},[ee,k]);const te=f(y,k)?k:void 0,ie=!!k&&React.createElement("img",{alt:Object(m.__)("Edit image"),title:Object(m.__)("Edit image"),className:"edit-image-preview",src:k});function $(e){const t=["wide","full"].includes(e)?{width:void 0,height:void 0}:{};i({...t,align:e})}Object(c.useEffect)(()=>{f(y,k)&&s&&!N&&window.fetch(k).then(e=>e.blob()).then(e=>V(e)).catch(()=>{})},[y,k,s,N]);const ae=Object(u.useBlockProps)({ref:J});return React.createElement(React.Fragment,null,React.createElement(u.BlockControls,{group:"block"},React.createElement(u.BlockAlignmentControl,{value:_,onChange:$}),N&&React.createElement(o.ToolbarButton,{onClick:function(){K({filesList:[N],onFileChange([e]){Y(e),Object(l.isBlobURL)(null==e?void 0:e.url)||(V(),T("success",Object(m.__)("Image uploaded."),{type:"snackbar"}))},allowedTypes:w,onError(e){T("error",e,{type:"snackbar"})}})},icon:d,label:Object(m.__)("Upload external image")})),React.createElement("figure",E({},ae,{className:n()(a,"uagb-editor-preview-mode-"+M.toLowerCase(),"uagb-block-"+j)}),(D||k)&&React.createElement(O,{temporaryURL:D,attributes:t,setAttributes:i,isSelected:s,insertBlocksAfter:b,onReplace:v,onSelectImage:Y,onSelectURL:Z,onUploadError:X,containerRef:J,context:p,clientId:R,onCloseModal:Q,onImageLoadError:function(e=!1){e||i({url:void 0,id:void 0})}}),!k&&React.createElement(u.BlockControls,{group:"block"},React.createElement(u.BlockAlignmentControl,{value:_,onChange:$})),React.createElement(u.MediaPlaceholder,{icon:React.createElement(u.BlockIcon,{icon:h}),onSelect:Y,onSelectURL:Z,onError:X,onClose:Q,accept:"image/*",allowedTypes:w,value:{id:y,src:te},mediaPreview:ie,disableMediaButtons:D||k})))};R.propTypes={},R.defaultProps={},t.default=R}}]);